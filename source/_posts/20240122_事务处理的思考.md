---
# 元数据配置
title: 事务处理的思考
date: 2024-01-22
update:  2024-01-22

# 标签和分类
tags:
categories: IT

# 其他配置
aside: true
cover: /zz_resource/post_top_img/1.50_512比341_b6vdxb2.jpg
---

# 没有调用别的平台的接口
出错时业务可以完全回滚，相当于接口没有被调用.

# 只调用了一个别的平台的接口
出错时业务可以完全回滚.
只需要把调用的时机放在接口最后，调用出错了就回滚.

# 调用了多个别的平台的接口
出错时业务无法完全回滚.
先调用接口A再调用接口B，接口B调用出错了，这时即使抛出异常回滚，只能回滚数据库，A的调用无法回滚了.
这时应该这样做：
把所有的接口调用都放在最后.
- 如果调用接口前出错了，抛出异常，完全回滚业务；
- 如果第一个接口调用出错，抛出异常，完全回滚业务；
- 如果后边的接口调用出错，这时不应该再抛出异常回滚，因为前边调用正常的接口已经无法回滚了，这时应该把调用不正常的接口记录到数据库或日志中供以后手动处理.

# 备注
当然接口全都是会修改对方平台的数据，也没有提供能把数据改回来的接口.